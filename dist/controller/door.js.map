{"version":3,"sources":["../../src/controller/door.js"],"names":["config","db","api","post","req","res","newFoodTruck","FoodTruck","name","body","foodtype","avgcost","geometry","coordinates","save","err","send","json","get","find","foodtrucks","findById","params","id","foodtruck","put","delete","status","remove","message","newReview","Review","title","text","_id","review","reviews","push"],"mappings":"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","file":"door.js","sourcesContent":["import mongoose from \"mongoose\";\nimport { Router } from \"express\";\nimport Door from \"../model/door\";\nimport User from \"../model/user\";\n\n\nexport default ({ config, db }) => {\n  let api = Router();\n\n  //'v1/foodtruck/add'\n  api.post('/add', (req, res) => {\n    let newFoodTruck = new FoodTruck();\n    newFoodTruck.name = req.body.name;\n    newFoodTruck.foodtype = req.body.foodtype;\n    newFoodTruck.avgcost = req.body.avgcost;\n    newFoodTruck.geometry.coordinates = req.body.geometry.coordinates;\n\n    newFoodTruck.save(err => {\n      if (err) {\n        res.send(err);\n      }\n      res.json({ \"message\": \"FoodTruck saved successfully\" });\n    });\n  });\n\n  //'v1/foodtruck'\n  api.get('/', (req, res) => {\n    FoodTruck.find({}, (err, foodtrucks) => {\n      if (err) {\n        res.send(err);\n      }\n      res.json(foodtrucks);\n    });\n  });\n\n  //'v1/foodtruck/:id' - READ\n  api.get('/:id', (req, res) => {\n    FoodTruck.findById(req.params.id, (err, foodtruck) => {\n      if (err) {\n        res.send(err);\n      }\n      res.json(foodtruck);\n    });\n  });\n\n  //'v1/foodtruck/:id' - UPDATE\n  api.put('/:id', (req, res) => {\n    FoodTruck.findById(req.params.id, (err, foodtruck) => {\n      if (err) {\n        res.send(err);\n      }\n      foodtruck.name = req.body.name;\n      foodtruck.save(err => {\n        if (err) {\n          res.send(err);\n        }\n        res.json({\"message\": \"FoodTruck info updated!\"});\n      });\n    });\n  });\n\n  //'v1/foodtruck/:id' - DELETE\n  api.delete('/:id', (req, res) => {\n    FoodTruck.findById(req.params.id, (err, foodtruck) => {\n      if (err) {\n        res.status(500).send(err);\n        return;\n      }\n      if (foodtruck === null) {\n        res.status(404).send(\"Foodtruck not found\");\n        return;\n      }\n      FoodTruck.remove({\n        \"_id\": req.params.id\n        },(err, foodtruck) => {\n          if (err) {\n            res.status(500).send(err);\n            return;\n          }\n          res.json({message: \"FoodTruck successfully removed!\"});\n      });\n    });\n  });\n\n\n  //add review for specific foodtruck id\n  // 'v1/foodtruck/reviews/add/:id'\n  api.post('/reviews/add/:id', (req, res) => {\n    FoodTruck.findById(req.params.id, (err, foodtruck) => {\n      if (err) {\n        res.send(err);\n      }\n      let newReview = new Review();\n      newReview.title = req.body.title;\n      newReview.text = req.body.text;\n      newReview.foodtruck = foodtruck._id;\n\n      newReview.save((err, review) => {\n        if (err) {\n          res.send(err);\n        }\n        foodtruck.reviews.push(newReview);\n        foodtruck.save(err => {\n          if (err) {\n            res.send(err);\n          }\n          res.json({message: \"Successfully saved review\"});\n        });\n      });\n    });\n  });\n\n\n  //get review for specific foodtruck id\n  // 'v1/foodtruck/reviews/:id'\n  api.get('/reviews/:id', (req, res) => {\n    Review.find({foodtruck: req.params.id}, (err, reviews) => {\n      if (err) {\n        res.send(err);\n      }\n      res.json(reviews);\n    });\n  });\n\n\n\n  return api;\n}\n"]}